<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/validation/validation-group-builder.js | Aurelia:Validation API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="symbols.html">Symbol</a>
  <a href="source.html">Source</a>
  <a href="test.html">Test</a>
  <a data-ice="repoURL" href="https://github.com/aurelia/validation" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div data-ice="classWrap">
  <h2>Class</h2>
  <ul>
    
  <li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~AlphaNumericOrWhitespaceValidationRule.html">AlphaNumericOrWhitespaceValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~AlphaNumericValidationRule.html">AlphaNumericValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~AlphaOrWhitespaceValidationRule.html">AlphaOrWhitespaceValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~AlphaValidationRule.html">AlphaValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~BetweenLengthValidationRule.html">BetweenLengthValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~BetweenValueValidationRule.html">BetweenValueValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~ContainsOnlyValidationRule.html">ContainsOnlyValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~CustomFunctionValidationRule.html">CustomFunctionValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/debouncer.js~Debouncer.html">Debouncer</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~DigitValidationRule.html">DigitValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~EmailValidationRule.html">EmailValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~EqualityValidationRule.html">EqualityValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~EqualityValidationRuleBase.html">EqualityValidationRuleBase</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~EqualityWithOtherLabelValidationRule.html">EqualityWithOtherLabelValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~InCollectionValidationRule.html">InCollectionValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~InEqualityValidationRule.html">InEqualityValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~InEqualityWithOtherLabelValidationRule.html">InEqualityWithOtherLabelValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MaximumInclusiveValueValidationRule.html">MaximumInclusiveValueValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MaximumLengthValidationRule.html">MaximumLengthValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MaximumValueValidationRule.html">MaximumValueValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MediumPasswordValidationRule.html">MediumPasswordValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MinimumInclusiveValueValidationRule.html">MinimumInclusiveValueValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MinimumLengthValidationRule.html">MinimumLengthValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~MinimumValueValidationRule.html">MinimumValueValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~NumericValidationRule.html">NumericValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/path-observer.js~PathObserver.html">PathObserver</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~RegexValidationRule.html">RegexValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~StrongPasswordValidationRule.html">StrongPasswordValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules-collection.js~SwitchCaseValidationRulesCollection.html">SwitchCaseValidationRulesCollection</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validate-custom-attribute-view-strategy.js~TWBootstrapViewStrategy.html">TWBootstrapViewStrategy</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/utilities.js~Utilities.html">Utilities</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validate-custom-attribute-view-strategy.js~ValidateCustomAttributeViewStrategy.html">ValidateCustomAttributeViewStrategy</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validate-custom-attribute-view-strategy.js~ValidateCustomAttributeViewStrategyBase.html">ValidateCustomAttributeViewStrategyBase</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-config.js~ValidationConfig.html">ValidationConfig</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-config.js~ValidationConfigDefaults.html">ValidationConfigDefaults</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-group.js~ValidationGroup.html">ValidationGroup</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-group-builder.js~ValidationGroupBuilder.html">ValidationGroupBuilder</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-locale.js~ValidationLocale.html">ValidationLocale</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-property.js~ValidationProperty.html">ValidationProperty</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-result.js~ValidationResult.html">ValidationResult</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-result.js~ValidationResultProperty.html">ValidationResultProperty</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules.js~ValidationRule.html">ValidationRule</a></span></li>
<li data-ice="classDoc"><span><a href="class/src/validation/validation-rules-collection.js~ValidationRulesCollection.html">ValidationRulesCollection</a></span></li>
</ul>
</div>



<div data-ice="functionWrap">
  <h2><a href="function/">Function</a></h2>
  <ul>
    
  <li data-ice="functionDoc"><span><a href="function/index.html#static-function-configure">configure</a></span></li>
<li data-ice="functionDoc"><span><a href="function/index.html#static-function-ensure">ensure</a></span></li>
</ul>
</div>

<div data-ice="variableWrap">
  <h2><a href="variable/">Variable</a></h2>
  <ul>
    
  <li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-data">data</a></span></li>
</ul>
</div>




</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/validation/validation-group-builder.js</h1>
<pre class="source-code line-number"><code class="prettyprint linenums" data-ice="content">import * as AllRules from &apos;../validation/validation-rules&apos;;
import * as AllCollections from &apos;../validation/validation-rules-collection&apos;
import {ValidationProperty} from &apos;../validation/validation-property&apos;;
import {ValidationConfig} from &apos;../validation/validation-config&apos;;

export class ValidationGroupBuilder {
  constructor(observerLocator, validationGroup) {
    this.observerLocator = observerLocator;
    this.validationRuleCollections = []; //Flattened out queue of the nested collections
    this.validationGroup = validationGroup;
  }

  ensure(propertyName, configurationCallback) {
    var newValidationProperty = null;
    this.validationRuleCollections = [];

    for (let i = 0; i &lt; this.validationGroup.validationProperties.length; i++) {
      if (this.validationGroup.validationProperties[i].propertyName === propertyName) {
        newValidationProperty = this.validationGroup.validationProperties[i];
        if(configurationCallback !== undefined &amp;&amp; typeof(configurationCallback) === &apos;function&apos;)
        {
          throw Error(&apos;When creating validation rules on binding path &apos; + propertyName + &apos; a configuration callback function was provided, but validation rules have previously already been instantiated for this binding path&apos;);
        }
        break;
      }
    }
    if (newValidationProperty === null) {
      var propertyResult = this.validationGroup.result.addProperty(propertyName);
      var config = new ValidationConfig(this.validationGroup.config);
      if(configurationCallback !== undefined &amp;&amp; typeof(configurationCallback) === &apos;function&apos;)
      {
        configurationCallback(config);
      }
      newValidationProperty = new ValidationProperty(this.observerLocator, propertyName, this.validationGroup, propertyResult, config );
      this.validationGroup.validationProperties.push(newValidationProperty);
    }
    this.validationRuleCollections.unshift(newValidationProperty.collectionOfValidationRules);
    return this.validationGroup;
  }

  isNotEmpty() {
    this.validationRuleCollections[0].isNotEmpty();
    this.checkLast();
    return this.validationGroup;
  }

  isGreaterThan(minimumValue) {
    return this.passesRule(new AllRules.MinimumValueValidationRule(minimumValue));
  }
  isGreaterThanOrEqualTo(minimumValue) {
    return this.passesRule(new AllRules.MinimumInclusiveValueValidationRule(minimumValue));
  }

  isBetween(minimumValue, maximumValue) {
    return this.passesRule(new AllRules.BetweenValueValidationRule(minimumValue, maximumValue));
  }

  isIn(collection) {
    return this.passesRule(new AllRules.InCollectionValidationRule(collection));
  }

  isLessThan(maximumValue) {
    return this.passesRule(new AllRules.MaximumValueValidationRule(maximumValue));
  }

  isLessThanOrEqualTo(maximumValue) {
    return this.passesRule(new AllRules.MaximumInclusiveValueValidationRule(maximumValue));
  }

  isEqualTo(otherValue, otherValueLabel) {
    if(!otherValueLabel)
      return this.passesRule(new AllRules.EqualityValidationRule(otherValue));
    else
      return this.passesRule(new AllRules.EqualityWithOtherLabelValidationRule(otherValue, otherValueLabel))
  }

  isNotEqualTo(otherValue, otherValueLabel) {
    if(!otherValueLabel)
      return this.passesRule(new AllRules.InEqualityValidationRule(otherValue));
    else
      return this.passesRule(new AllRules.InEqualityWithOtherLabelValidationRule(otherValue, otherValueLabel))
  }

  isEmail() {
    return this.passesRule(new AllRules.EmailValidationRule());
  }

  hasMinLength(minimumValue) {
    return this.passesRule(new AllRules.MinimumLengthValidationRule(minimumValue));
  }

  hasMaxLength(maximumValue) {
    return this.passesRule(new AllRules.MaximumLengthValidationRule(maximumValue));
  }

  hasLengthBetween(minimumValue, maximumValue) {
    return this.passesRule(new AllRules.BetweenLengthValidationRule(minimumValue, maximumValue));
  }

  isNumber() {
    return this.passesRule(new AllRules.NumericValidationRule());
  }

  containsOnlyDigits() {
    return this.passesRule(new AllRules.DigitValidationRule());
  }

  containsOnlyAlpha(){
    return this.passesRule(new AllRules.AlphaValidationRule());
  }

  containsOnlyAlphaOrWhitespace(){
    return this.passesRule(new AllRules.AlphaOrWhitespaceValidationRule());
  }

  containsOnlyAlphanumerics(){
    return this.passesRule(new AllRules.AlphaNumericValidationRule());
  }

  containsOnlyAlphanumericsOrWhitespace() {
    return this.passesRule(new AllRules.AlphaNumericOrWhitespaceValidationRule());
  }

  isStrongPassword(minimumComplexityLevel) {
    if(minimumComplexityLevel === 4)
      return this.passesRule(new AllRules.StrongPasswordValidationRule());
    else
      return this.passesRule(new AllRules.MediumPasswordValidationRule(minimumComplexityLevel));
  }

  containsOnly(regex)
  {
    return this.passesRule(new AllRules.ContainsOnlyValidationRule(regex));
  }

  matches(regex) {
    return this.passesRule(new AllRules.RegexValidationRule(regex));
  }

  passes(customFunction, threshold) {
    return this.passesRule(new AllRules.CustomFunctionValidationRule(customFunction, threshold));
  }

  passesRule(validationRule) {

    this.validationRuleCollections[0].addValidationRule(validationRule);
    this.checkLast();
    return this.validationGroup;
  }

  checkLast() {
    var validationProperty = this.validationGroup.validationProperties[this.validationGroup.validationProperties.length - 1];
    validationProperty.validateCurrentValue(false);
  }

  withMessage(message) {
    this.validationRuleCollections[0].withMessage(message);
    this.checkLast();
    return this.validationGroup;
  }

  if(conditionExpression) {
    //IF is treated as a &apos;switch&apos; with case &apos;true&apos; and &apos;default&apos;
    var conditionalCollection = new AllCollections.SwitchCaseValidationRulesCollection(conditionExpression);
    conditionalCollection.case(true);
    this.validationRuleCollections[0].addValidationRuleCollection(conditionalCollection);
    this.validationRuleCollections.unshift(conditionalCollection);
    return this.validationGroup;
  }

  else() {
    if (!this.validationRuleCollections[0].default)
      throw &apos;Invalid statement: \&apos;else\&apos;&apos;;
    //this.validationRuleCollections[0].case(false);
    this.validationRuleCollections[0].default();//slightly less object creation then &apos;case false&apos;
    return this.validationGroup;
  }

  endIf() {
    if (!this.validationRuleCollections[0].default)
      throw &apos;Invalid statement: \&apos;endIf\&apos;&apos;;
    this.validationRuleCollections.shift(); //go up one level in the nested collections
    this.checkLast();
    return this.validationGroup;
  }

  switch(conditionExpression) {
    var condition = conditionExpression;
    if (condition === undefined) {
      let observer = this.validationGroup.validationProperties[this.validationGroup.validationProperties.length - 1].observer;
      condition = () =&gt; {
        return observer.getValue();
      };
    }
    var conditionalCollection = new AllCollections.SwitchCaseValidationRulesCollection(condition);
    this.validationRuleCollections[0].addValidationRuleCollection(conditionalCollection);
    this.validationRuleCollections.unshift(conditionalCollection);
    return this.validationGroup;
  }

  case(caseLabel) {
    if (!this.validationRuleCollections[0].default)
      throw &apos;Invalid statement: \&apos;case\&apos;&apos;;
    this.validationRuleCollections[0].case(caseLabel);
    return this.validationGroup;
  }

  default() {
    if (!this.validationRuleCollections[0].default)
      throw &apos;Invalid statement: \&apos;case\&apos;&apos;;
    this.validationRuleCollections[0].default();
    return this.validationGroup;
  }

  endSwitch() {
    if (!this.validationRuleCollections[0].default)
      throw &apos;Invalid statement: \&apos;endIf\&apos;&apos;;
    this.validationRuleCollections.shift(); //go up one level in the nested collections
    this.checkLast();
    return this.validationGroup;
  }
}
</code></pre>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.0.2)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
</body>
</html>
